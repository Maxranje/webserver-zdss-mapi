/* empty css                */import{_ as B}from"./logo-C4z1NPn2.js";/* empty css                     *//* empty css                  *//* empty css                    *//* empty css                 */import{d as $,u as N,L as Z,g as S,r as P,M as z,h as j,c as k,o as g,a as l,j as s,N as C,i as o,O as T,P as M,Q as W,b as y,R as A,S as q,f as G,T as H,q as V,_ as F,s as K,z as O,G as Q,e as U,U as x,V as X,F as Y,m as D,W as J,X as ee}from"./index-BifspBj0.js";const se={class:"login-form-wrapper"},oe={class:"login-form"},re={class:"form-options"},L="remember-username",te=$({__name:"LoginForm",emits:["switchToReset"],setup(I){const u=N();Z();const d=S(),m=P(!1),i=P(),a=z({username:"",password:""}),r={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{pattern:/^[0-9a-zA-Z,]{1,20}$/,message:"用户名只能包含数字、英文或逗号，1-20个字符以内",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^[0-9a-zA-Z,]{6,20}$/,message:"密码只能包含数字、英文或逗号，6-20个字符以内",trigger:"blur"}]};j(()=>{const t=localStorage.getItem(L);t&&(a.username=t,m.value=!0)});const f=t=>{localStorage.setItem(L,t)},w=()=>{localStorage.removeItem(L)},v=async()=>{if(!i.value)return!1;try{return await i.value.validate(),!0}catch{return!1}},b=async()=>{try{if(!await v())return;const e=await d.login({username:a.username,password:a.password});e.success?(m.value?f(a.username):w(),d.userInfo&&d.userInfo.roleType==1?H("/mapi/dashboard/page"):u.push(e.redirect||"/profile")):V.error(e.message||"登录失败，请检查用户名和密码")}catch(t){console.error("登录处理异常:",t),V.error("登录异常，请检查网络连接")}};return(t,e)=>{const p=M,n=T,R=W,E=A,h=q,c=C;return g(),k("div",se,[l("div",oe,[e[7]||(e[7]=l("h3",{class:"form-title"},"账户登录",-1)),s(c,{ref_key:"loginFormRef",ref:i,model:a,rules:r,size:"large"},{default:o(()=>[s(n,{prop:"username"},{default:o(()=>[s(p,{modelValue:a.username,"onUpdate:modelValue":e[0]||(e[0]=_=>a.username=_),placeholder:"请输入用户名","prefix-icon":"User",clearable:""},null,8,["modelValue"])]),_:1}),s(n,{prop:"password"},{default:o(()=>[s(p,{modelValue:a.password,"onUpdate:modelValue":e[1]||(e[1]=_=>a.password=_),type:"password",placeholder:"请输入密码","prefix-icon":"Lock","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),s(n,null,{default:o(()=>[l("div",re,[s(R,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=_=>m.value=_)},{default:o(()=>e[4]||(e[4]=[y("记住用户名")])),_:1,__:[4]},8,["modelValue"]),s(E,{type:"primary",underline:"never",onClick:e[3]||(e[3]=_=>t.$emit("switchToReset"))},{default:o(()=>e[5]||(e[5]=[y("修改密码")])),_:1,__:[5]})])]),_:1}),s(n,null,{default:o(()=>[s(h,{type:"primary",size:"large",style:{width:"100%"},loading:G(d).loading,onClick:b},{default:o(()=>e[6]||(e[6]=[y(" 登录系统 ")])),_:1,__:[6]},8,["loading"])]),_:1})]),_:1},8,["model"])])])}}}),ae=F(te,[["__scopeId","data-v-ccc87267"]]),le={class:"login-form-wrapper"},ne={class:"login-form"},ie={class:"form-options"},ue=$({__name:"ResetPassForm",emits:["switchToLogin"],setup(I,{emit:u}){const d=u,m=S(),i=P(!1),a=P(),r=z({username:"",oldPassword:"",newPassword:""}),f={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{pattern:/^[0-9a-zA-Z,]{1,20}$/,message:"用户名只能包含数字、英文或逗号，1-20个字符以内",trigger:"blur"}],oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"},{pattern:/^[0-9a-zA-Z,]{6,20}$/,message:"旧密码只能包含数字、英文或逗号，6-20个字符以内",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{pattern:/^[0-9a-zA-Z,]{6,20}$/,message:"新密码只能包含数字、英文或逗号，6-20个字符以内",trigger:"blur"}]},w=async()=>{if(!a.value)return!1;try{return await a.value.validate(),!0}catch{return!1}},v=()=>{r.username="",r.oldPassword="",r.newPassword="",a.value?.clearValidate()},b=async()=>{try{if(!await w())return;i.value=!0;const e=await m.resetPassword({username:r.username,oldPassword:r.oldPassword,newPassword:r.newPassword});e.success?(V.success("密码修改成功，请使用新密码登录"),v(),d("switchToLogin")):V.error(e.message||"密码修改失败，请检查输入信息")}catch(t){console.error("修改密码请求失败:",t),V.error("修改密码失败，请检查网络连接")}finally{i.value=!1}};return(t,e)=>{const p=M,n=T,R=A,E=q,h=C;return g(),k("div",le,[l("div",ne,[e[7]||(e[7]=l("h3",{class:"form-title"},"修改密码",-1)),s(h,{ref_key:"resetFormRef",ref:a,model:r,rules:f,size:"large"},{default:o(()=>[s(n,{prop:"username"},{default:o(()=>[s(p,{modelValue:r.username,"onUpdate:modelValue":e[0]||(e[0]=c=>r.username=c),placeholder:"请输入用户名","prefix-icon":"User",clearable:""},null,8,["modelValue"])]),_:1}),s(n,{prop:"oldPassword"},{default:o(()=>[s(p,{modelValue:r.oldPassword,"onUpdate:modelValue":e[1]||(e[1]=c=>r.oldPassword=c),type:"password",placeholder:"请输入旧密码","prefix-icon":"Lock","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),s(n,{prop:"newPassword"},{default:o(()=>[s(p,{modelValue:r.newPassword,"onUpdate:modelValue":e[2]||(e[2]=c=>r.newPassword=c),type:"password",placeholder:"请输入新密码","prefix-icon":"Lock","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),s(n,null,{default:o(()=>[l("div",ie,[e[5]||(e[5]=l("span",null,null,-1)),s(R,{type:"primary",underline:"never",onClick:e[3]||(e[3]=c=>t.$emit("switchToLogin"))},{default:o(()=>e[4]||(e[4]=[y("去登录")])),_:1,__:[4]})])]),_:1}),s(n,null,{default:o(()=>[s(E,{type:"primary",size:"large",style:{width:"100%"},loading:i.value,onClick:b},{default:o(()=>e[6]||(e[6]=[y(" 确认修改 ")])),_:1,__:[6]},8,["loading"])]),_:1})]),_:1},8,["model"])])])}}}),de=F(ue,[["__scopeId","data-v-b207db63"]]),me={class:"login-page"},ce={class:""},pe={class:"carousel-bg"},_e=$({__name:"LoginView",setup(I){const u=P(!1),d=[{id:1,url:"/img/photo-1481627834876-b7833e8f5570.jpg"},{id:2,url:"/img/photo-1503676260728-1c00da094a0b.jpg"},{id:3,url:"/img/photo-1523050854058-8df90110c9f1.jpg"}],m=()=>{u.value=!0},i=()=>{u.value=!1};return(a,r)=>{const f=O,w=J,v=X,b=Q,t=K;return g(),k("div",me,[s(t,null,{default:o(()=>[s(f,{class:"top-bar"},{default:o(()=>r[0]||(r[0]=[l("div",{class:"logo"},[l("img",{src:B,alt:"Logo"})],-1)])),_:1,__:[0]}),s(b,{class:"login-container"},{default:o(()=>[l("div",ce,[l("div",pe,[s(v,{interval:5e3,arrow:"never","indicator-position":"none"},{default:o(()=>[(g(),k(Y,null,D(d,e=>s(w,{key:e.id},{default:o(()=>[l("div",{class:"carousel-item",style:ee({backgroundImage:`url(${e.url})`})},null,4)]),_:2},1024)),64))]),_:1})]),u.value?x("",!0):(g(),U(ae,{key:0,onSwitchToReset:m})),u.value?(g(),U(de,{key:1,onSwitchToLogin:i})):x("",!0)])]),_:1})]),_:1})])}}}),Pe=F(_e,[["__scopeId","data-v-037fc0c1"]]);export{Pe as default};
