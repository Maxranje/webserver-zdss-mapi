/* empty css                */import{_ as q}from"./logo-C4z1NPn2.js";/* empty css                     *//* empty css                  *//* empty css                    *//* empty css                 */import{d as F,v as N,Q as j,u as S,z as P,R as z,A as Y,a as R,x as f,b as a,e as o,S as C,w as t,T,U as A,V as G,j as V,W as M,k as B,l as H,o as k,_ as L,E as K,f as Q,g as W,y as I,X as U,Y as X,F as D,G as J,Z as O,$ as ee}from"./index-Ct0AKhoQ.js";const se={class:"login-form-wrapper"},oe={class:"login-form"},re={class:"form-options"},h="remember-username",te=F({__name:"LoginForm",emits:["switchToReset"],setup(x,{emit:c}){const p=N();j();const i=S(),l=P(!1),n=P(),s=z({username:"",password:""}),w={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{pattern:/^[0-9a-zA-Z,]{1,20}$/,message:"用户名只能包含数字、英文或逗号，1-20个字符以内",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^[0-9a-zA-Z,]{6,20}$/,message:"密码只能包含数字、英文或逗号，6-20个字符以内",trigger:"blur"}]};Y(()=>{const e=localStorage.getItem(h);e&&(s.username=e,l.value=!0)});const v=e=>{localStorage.setItem(h,e)},b=()=>{localStorage.removeItem(h)},y=async()=>{if(!n.value)return!1;try{return await n.value.validate(),!0}catch{return!1}},u=async()=>{try{if(!await y())return;const r=await i.login({username:s.username,password:s.password});r.success?(l.value?v(s.username):b(),i.userInfo&&i.userInfo.roleType==1?p.push("/choice"):p.push(r.redirect||"/profile")):k.error(r.message||"登录失败，请检查用户名和密码")}catch(e){console.error("登录处理异常:",e),k.error("登录异常，请检查网络连接")}};return(e,r)=>{const d=A,_=T,E=G,$=M,m=B,Z=C;return f(),R("div",se,[a("div",oe,[r[7]||(r[7]=a("h3",{class:"form-title"},"账户登录",-1)),o(Z,{ref_key:"loginFormRef",ref:n,model:s,rules:w,size:"large"},{default:t(()=>[o(_,{prop:"username"},{default:t(()=>[o(d,{modelValue:s.username,"onUpdate:modelValue":r[0]||(r[0]=g=>s.username=g),placeholder:"请输入用户名","prefix-icon":"User",clearable:""},null,8,["modelValue"])]),_:1}),o(_,{prop:"password"},{default:t(()=>[o(d,{modelValue:s.password,"onUpdate:modelValue":r[1]||(r[1]=g=>s.password=g),type:"password",placeholder:"请输入密码","prefix-icon":"Lock","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),o(_,null,{default:t(()=>[a("div",re,[o(E,{modelValue:l.value,"onUpdate:modelValue":r[2]||(r[2]=g=>l.value=g)},{default:t(()=>r[4]||(r[4]=[V("记住用户名")])),_:1,__:[4]},8,["modelValue"]),o($,{type:"primary",underline:"never",onClick:r[3]||(r[3]=g=>e.$emit("switchToReset"))},{default:t(()=>r[5]||(r[5]=[V("修改密码")])),_:1,__:[5]})])]),_:1}),o(_,null,{default:t(()=>[o(m,{type:"primary",size:"large",style:{width:"100%"},loading:H(i).loading,onClick:u},{default:t(()=>r[6]||(r[6]=[V(" 登录系统 ")])),_:1,__:[6]},8,["loading"])]),_:1})]),_:1},8,["model"])])])}}}),ae=L(te,[["__scopeId","data-v-44f290b4"]]),le={class:"login-form-wrapper"},ne={class:"login-form"},ie={class:"form-options"},ue=F({__name:"ResetPassForm",emits:["switchToLogin"],setup(x,{emit:c}){const p=c,i=S(),l=P(!1),n=P(),s=z({username:"",oldPassword:"",newPassword:""}),w={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{pattern:/^[0-9a-zA-Z,]{1,20}$/,message:"用户名只能包含数字、英文或逗号，1-20个字符以内",trigger:"blur"}],oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"},{pattern:/^[0-9a-zA-Z,]{6,20}$/,message:"旧密码只能包含数字、英文或逗号，6-20个字符以内",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{pattern:/^[0-9a-zA-Z,]{6,20}$/,message:"新密码只能包含数字、英文或逗号，6-20个字符以内",trigger:"blur"}]},v=async()=>{if(!n.value)return!1;try{return await n.value.validate(),!0}catch{return!1}},b=()=>{s.username="",s.oldPassword="",s.newPassword="",n.value?.clearValidate()},y=async()=>{try{if(!await v())return;l.value=!0;const e=await i.resetPassword({username:s.username,oldPassword:s.oldPassword,newPassword:s.newPassword});e.success?(k.success("密码修改成功，请使用新密码登录"),b(),p("switchToLogin")):k.error(e.message||"密码修改失败，请检查输入信息")}catch(u){console.error("修改密码请求失败:",u),k.error("修改密码失败，请检查网络连接")}finally{l.value=!1}};return(u,e)=>{const r=A,d=T,_=M,E=B,$=C;return f(),R("div",le,[a("div",ne,[e[7]||(e[7]=a("h3",{class:"form-title"},"修改密码",-1)),o($,{ref_key:"resetFormRef",ref:n,model:s,rules:w,size:"large"},{default:t(()=>[o(d,{prop:"username"},{default:t(()=>[o(r,{modelValue:s.username,"onUpdate:modelValue":e[0]||(e[0]=m=>s.username=m),placeholder:"请输入用户名","prefix-icon":"User",clearable:""},null,8,["modelValue"])]),_:1}),o(d,{prop:"oldPassword"},{default:t(()=>[o(r,{modelValue:s.oldPassword,"onUpdate:modelValue":e[1]||(e[1]=m=>s.oldPassword=m),type:"password",placeholder:"请输入旧密码","prefix-icon":"Lock","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),o(d,{prop:"newPassword"},{default:t(()=>[o(r,{modelValue:s.newPassword,"onUpdate:modelValue":e[2]||(e[2]=m=>s.newPassword=m),type:"password",placeholder:"请输入新密码","prefix-icon":"Lock","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),o(d,null,{default:t(()=>[a("div",ie,[e[5]||(e[5]=a("span",null,null,-1)),o(_,{type:"primary",underline:"never",onClick:e[3]||(e[3]=m=>u.$emit("switchToLogin"))},{default:t(()=>e[4]||(e[4]=[V("去登录")])),_:1,__:[4]})])]),_:1}),o(d,null,{default:t(()=>[o(E,{type:"primary",size:"large",style:{width:"100%"},loading:l.value,onClick:y},{default:t(()=>e[6]||(e[6]=[V(" 确认修改 ")])),_:1,__:[6]},8,["loading"])]),_:1})]),_:1},8,["model"])])])}}}),de=L(ue,[["__scopeId","data-v-b207db63"]]),me={class:"login-page"},ce={class:""},pe={class:"carousel-bg"},_e=F({__name:"LoginView",setup(x){const c=P(!1),p=[{id:1,url:"/img/photo-1481627834876-b7833e8f5570.jpg"},{id:2,url:"/img/photo-1503676260728-1c00da094a0b.jpg"},{id:3,url:"/img/photo-1523050854058-8df90110c9f1.jpg"}],i=()=>{c.value=!0},l=()=>{c.value=!1};return(n,s)=>{const w=Q,v=O,b=X,y=W,u=K;return f(),R("div",me,[o(u,null,{default:t(()=>[o(w,{class:"top-bar"},{default:t(()=>s[0]||(s[0]=[a("div",{class:"logo"},[a("img",{src:q,alt:"Logo"})],-1)])),_:1,__:[0]}),o(y,{class:"login-container"},{default:t(()=>[a("div",ce,[a("div",pe,[o(b,{interval:5e3,arrow:"never","indicator-position":"none"},{default:t(()=>[(f(),R(D,null,J(p,e=>o(v,{key:e.id},{default:t(()=>[a("div",{class:"carousel-item",style:ee({backgroundImage:`url(${e.url})`})},null,4)]),_:2},1024)),64))]),_:1})]),c.value?U("",!0):(f(),I(ae,{key:0,onSwitchToReset:i})),c.value?(f(),I(de,{key:1,onSwitchToLogin:l})):U("",!0)])]),_:1})]),_:1})])}}}),ke=L(_e,[["__scopeId","data-v-037fc0c1"]]);export{ke as default};
