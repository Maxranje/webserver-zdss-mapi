/* empty css                *//* empty css                  */import{d as X,z as f,a0 as Q,a as r,b as e,t as c,F as P,G as B,H as j,y as E,X as H,w as v,e as o,r as k,h as G,x as l,_ as J,c as W,j as V,U as ae,k as Z,$ as ee,q as ce,o as S,E as ue,a9 as de,g as re,aa as _e,a8 as oe,ab as ve,A as pe,O as me,ac as he,v as ge}from"./index-Ca6ax7r6.js";/* empty css                 */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                    */const fe={class:"choice-question"},$e={class:"question-header"},we={class:"question-title"},qe={class:"question-number"},ye={class:"question-content"},ke={class:"question-text"},Ce={class:"options-container"},be=["onClick"],xe={class:"option-indicator"},Se={key:0,class:"checkbox"},Te={key:1,class:"radio"},Ie={key:0,class:"radio-dot"},Ve={class:"option-content"},Ae={class:"option-label"},Le={class:"option-text"},Re={class:"question-info"},Me={class:"selection-type"},Ee=X({__name:"ChoiceQuestion",props:{question:{},answer:{}},emits:["answer-change"],setup(A,{emit:T}){const i=A,y=T,t=f([]);i.answer&&(Array.isArray(i.answer)?t.value=[...i.answer]:t.value=[i.answer]);const u=_=>t.value.includes(_),p=_=>{if(i.question.multiple){const m=t.value.indexOf(_);m>-1?t.value.splice(m,1):t.value.push(_),y("answer-change",[...t.value])}else t.value=[_],y("answer-change",_)};return Q(()=>i.question.id,()=>{t.value=[],i.answer&&(Array.isArray(i.answer)?t.value=[...i.answer]:t.value=[i.answer])}),(_,m)=>{const d=k("Check"),C=G;return l(),r("div",fe,[e("div",$e,[e("h3",we,c(_.question.title),1),e("div",qe,"第 "+c(_.question.id)+" 题",1)]),e("div",ye,[e("p",ke,c(_.question.content),1)]),e("div",Ce,[(l(!0),r(P,null,B(_.question.options,$=>(l(),r("div",{key:$.id,class:j(["option-card",{selected:u($.id),multiple:_.question.multiple}]),onClick:b=>p($.id)},[e("div",xe,[_.question.multiple?(l(),r("div",Se,[u($.id)?(l(),E(C,{key:0},{default:v(()=>[o(d)]),_:1})):H("",!0)])):(l(),r("div",Te,[u($.id)?(l(),r("div",Ie)):H("",!0)]))]),e("div",Ve,[e("span",Ae,c($.id)+".",1),e("span",Le,c($.text),1)])],10,be))),128))]),e("div",Re,[e("span",Me,c(_.question.multiple?"多选题（可选择多个答案）":"单选题（请选择一个答案）"),1)])])}}}),le=J(Ee,[["__scopeId","data-v-da6f95b0"]]),Pe={class:"fill-blank"},Be={class:"question-header"},De={class:"question-title"},ze={class:"question-number"},Ue={class:"question-content"},He=["innerHTML"],We={class:"blanks-container"},Fe={class:"blank-inputs"},Ne={class:"blank-label"},Oe={class:"question-info"},Qe={class:"fill-tip"},je=X({__name:"FillBlank",props:{question:{},answer:{}},emits:["answer-change"],setup(A,{emit:T}){const i=A,y=T,t=f({});i.answer?t.value={...i.answer}:i.question.blanks.forEach(_=>{t.value[_.id]=""});const u=W(()=>{let _=i.question.content,m=0;return _=_.replace(/_{3,}/g,()=>{m++;const d=t.value[m]||"";return`<span class="blank-placeholder" data-index="${m}">
      <span class="blank-number">${m}</span>
      <span class="blank-content">${d||"______"}</span>
    </span>`}),_}),p=()=>{y("answer-change",{...t.value})};return Q(()=>i.question.id,()=>{t.value={},i.answer?t.value={...i.answer}:i.question.blanks.forEach(_=>{t.value[_.id]=""})},{immediate:!0}),(_,m)=>{const d=ae,C=k("InfoFilled"),$=G;return l(),r("div",Pe,[e("div",Be,[e("h3",De,c(_.question.title),1),e("div",ze,"第 "+c(_.question.id)+" 题",1)]),e("div",Ue,[e("div",{class:"question-text",innerHTML:u.value},null,8,He)]),e("div",We,[e("div",Fe,[(l(!0),r(P,null,B(_.question.blanks,(b,L)=>(l(),r("div",{key:b.id,class:"blank-item"},[e("label",Ne,"空格 "+c(L+1)+"：",1),o(d,{modelValue:t.value[b.id],"onUpdate:modelValue":g=>t.value[b.id]=g,placeholder:b.placeholder||"请填写答案",size:"large",clearable:"",onInput:p,class:"blank-input"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]))),128))])]),e("div",Oe,[e("span",Qe,[o($,null,{default:v(()=>[o(C)]),_:1}),m[0]||(m[0]=V(" 请在上方输入框中填写对应的答案，答案将自动填入题目中的空白处 "))])])])}}}),Xe=J(je,[["__scopeId","data-v-8c1889c2"]]),Ge={class:"writing-question"},Je={class:"question-header"},Ke={class:"question-title"},Ye={class:"question-number"},Ze={class:"question-content"},et={class:"question-text"},tt={class:"writing-area"},st={class:"writing-header"},nt={class:"word-count"},ot={class:"word-range"},it={class:"writing-tips"},lt={class:"writing-toolbar"},at={class:"toolbar-left"},ct={class:"toolbar-right"},ut={class:"progress-text"},dt={class:"progress-bar"},rt=X({__name:"Writing",props:{question:{},answer:{}},emits:["answer-change"],setup(A,{emit:T}){const i=A,y=T,t=f("");i.answer&&(t.value=i.answer);const u=W(()=>t.value.replace(/\s/g,"").length),p=()=>{y("answer-change",t.value)},_=()=>{ce.confirm("确定要清空所有内容吗？此操作不可恢复。","清空确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{t.value="",p(),S.success("内容已清空")}).catch(()=>{})},m=()=>{localStorage.setItem(`writing_${i.question.id}`,t.value),S.success("已保存到本地")};return Q(()=>i.question.id,()=>{t.value=i.answer||"";const d=localStorage.getItem(`writing_${i.question.id}`);d&&!i.answer&&(t.value=d,p())},{immediate:!0}),(d,C)=>{const $=k("EditPen"),b=G,L=ae,g=Z;return l(),r("div",Ge,[e("div",Je,[e("h3",Ke,c(d.question.title),1),e("div",Ye,"第 "+c(d.question.id)+" 题",1)]),e("div",Ze,[e("p",et,c(d.question.content),1)]),e("div",tt,[e("div",st,[e("div",nt,[e("span",{class:j({warning:u.value<d.question.minWords,success:u.value>=d.question.minWords})}," 字数："+c(u.value),3),e("span",ot,"（要求："+c(d.question.minWords)+" - "+c(d.question.maxWords)+" 字）",1)]),e("div",it,[o(b,null,{default:v(()=>[o($)]),_:1}),C[1]||(C[1]=e("span",null,"请在下方文本框中写作",-1))])]),o(L,{modelValue:t.value,"onUpdate:modelValue":C[0]||(C[0]=a=>t.value=a),type:"textarea",rows:16,placeholder:"请在此处开始写作...",resize:"none",onInput:p,class:"writing-textarea"},null,8,["modelValue"]),e("div",lt,[e("div",at,[o(g,{size:"small",onClick:_,disabled:!t.value},{default:v(()=>C[2]||(C[2]=[V("清空内容")])),_:1,__:[2]},8,["disabled"]),o(g,{size:"small",onClick:m},{default:v(()=>C[3]||(C[3]=[V("本地保存")])),_:1,__:[3]})]),e("div",ct,[e("span",ut," 进度："+c(Math.min(100,Math.round(u.value/d.question.minWords*100)))+"% ",1),e("div",dt,[e("div",{class:"progress-fill",style:ee({width:`${Math.min(100,u.value/d.question.minWords*100)}%`})},null,4)])])])])])}}}),_t=J(rt,[["__scopeId","data-v-59ef54f2"]]),vt={class:"reading-question"},pt={class:"question-header"},mt={class:"question-title"},ht={class:"question-number"},gt={class:"passage-header"},ft={class:"passage-tools"},$t=["innerHTML"],wt={class:"questions-header"},qt={class:"questions-list"},yt=["id"],kt=["onClick"],Ct={class:"question-index"},bt={class:"question-text"},xt={class:"question-options"},St=["onClick"],Tt={class:"option-label"},It={class:"option-text"},Vt=X({__name:"Reading",props:{question:{},answer:{}},emits:["answer-change"],setup(A,{emit:T}){const i=A,y=T,t=f({}),u=f(new Set);i.answer&&(t.value={...i.answer});const p=W(()=>i.question.passage.split(`
`).filter(a=>a.trim()).map((a,h)=>u.value.has(h)?`<span class="highlighted-sentence">${a}</span>`:a)),_=(g,a)=>t.value[g]===a,m=(g,a)=>{t.value[g]=a,y("answer-change",{...t.value})};let d=null;const C=()=>{const g=window.getSelection();g&&g.rangeCount>0&&(d=g.getRangeAt(0).cloneRange())},$=()=>{d?d.toString().trim()?S.success("已高亮选中文本"):S.warning("请先选择要高亮的文本"):S.warning("请先选择要高亮的文本")},b=()=>{u.value.clear(),S.success("已清除所有高亮")},L=g=>{const a=document.querySelector(".passage-content");if(a){const h=(g-1)*100;a.scrollTo({top:h,behavior:"smooth"})}S.info(`定位到第 ${g} 题相关内容`)};return Q(()=>i.question.id,()=>{t.value=i.answer||{},u.value.clear()},{immediate:!0}),(g,a)=>{const h=k("Highlight"),D=G,R=Z,F=de,z=k("Location"),x=re,w=ue;return l(),r("div",vt,[e("div",pt,[e("h3",mt,c(g.question.title),1),e("div",ht,"第 "+c(g.question.id)+" 题",1)]),o(w,{class:"reading-container"},{default:v(()=>[o(F,{width:"55%",class:"passage-area"},{default:v(()=>[e("div",gt,[a[2]||(a[2]=e("h4",null,"阅读材料",-1)),e("div",ft,[o(R,{size:"small",onClick:$},{default:v(()=>[o(D,null,{default:v(()=>[o(h)]),_:1}),a[0]||(a[0]=V(" 高亮句子 "))]),_:1,__:[0]}),o(R,{size:"small",onClick:b},{default:v(()=>a[1]||(a[1]=[V("清除高亮")])),_:1,__:[1]})])]),e("div",{class:"passage-content",onMouseup:C},[(l(!0),r(P,null,B(p.value,(s,n)=>(l(),r("div",{key:n,class:"passage-paragraph",innerHTML:s},null,8,$t))),128))],32)]),_:1}),o(x,{class:"questions-area"},{default:v(()=>[e("div",wt,[e("h4",null,"问题 ("+c(g.question.questions.length)+" 题)",1)]),e("div",qt,[(l(!0),r(P,null,B(g.question.questions,(s,n)=>(l(),r("div",{key:s.id,id:`question-${s.id}`,class:"question-item"},[e("div",{class:"question-title-bar",onClick:q=>L(s.id)},[e("span",Ct,c(n+1)+".",1),e("span",bt,c(s.question),1),o(D,{class:"locate-icon"},{default:v(()=>[o(z)]),_:1})],8,kt),e("div",xt,[(l(!0),r(P,null,B(s.options,q=>(l(),r("div",{key:q.id,class:j(["option-item",{selected:_(s.id,q.id)}]),onClick:M=>m(s.id,q.id)},[e("span",Tt,c(q.id),1),e("span",It,c(q.text),1)],10,St))),128))])],8,yt))),128))])]),_:1})]),_:1})])}}}),At=J(Vt,[["__scopeId","data-v-912b5353"]]),Lt={class:"matching-question"},Rt={class:"question-header"},Mt={class:"question-title"},Et={class:"question-number"},Pt={class:"matching-container"},Bt={class:"matching-area"},Dt={class:"left-column"},zt={class:"items-list"},Ut=["onClick"],Ht={class:"item-index"},Wt={class:"item-text"},Ft={class:"connection-area"},Nt={class:"connection-lines"},Ot={class:"right-column"},Qt={class:"items-list"},jt=["onClick"],Xt={class:"item-index"},Gt={class:"item-text"},Jt={class:"connections-list"},Kt={class:"connection-items"},Yt={class:"left-text"},Zt={class:"right-text"},es={key:0,class:"no-connections"},ts={class:"question-info"},ss={class:"matching-tip"},ns=X({__name:"Matching",props:{question:{},answer:{}},emits:["answer-change"],setup(A,{emit:T}){const i=A,y=T,t=f([]),u=f(null),p=f(null);i.answer&&(t.value=[...i.answer]);const _=a=>t.value.some(h=>h.left===a),m=a=>t.value.some(h=>h.right===a),d=a=>{if(u.value?.id===a.id){u.value=null;return}u.value=a,p.value&&$()},C=a=>{if(p.value?.id===a.id){p.value=null;return}p.value=a,u.value&&$()},$=()=>{if(!u.value||!p.value)return;const a=t.value.findIndex(h=>h.left===u.value.id||h.right===p.value.id);a>-1&&t.value.splice(a,1),t.value.push({left:u.value.id,right:p.value.id}),u.value=null,p.value=null,y("answer-change",[...t.value]),S.success("连接已建立")},b=a=>{t.value.splice(a,1),y("answer-change",[...t.value]),S.success("连接已删除")},L=a=>i.question.leftItems.find(h=>h.id===a)?.text||"",g=a=>i.question.rightItems.find(h=>h.id===a)?.text||"";return Q(()=>i.question.id,()=>{t.value=i.answer||[],u.value=null,p.value=null},{immediate:!0}),(a,h)=>{const D=k("Right"),R=G,F=k("Delete"),z=Z,x=k("Connection"),w=k("InfoFilled");return l(),r("div",Lt,[e("div",Rt,[e("h3",Mt,c(a.question.title),1),e("div",Et,"第 "+c(a.question.id)+" 题",1)]),e("div",Pt,[e("div",Bt,[e("div",Dt,[h[1]||(h[1]=e("h4",{class:"column-title"},"左侧选项",-1)),e("div",zt,[(l(!0),r(P,null,B(a.question.leftItems,s=>(l(),r("div",{key:s.id,class:j(["matching-item","left-item",{selected:u.value?.id===s.id,connected:_(s.id)}]),onClick:n=>d(s)},[e("div",Ht,c(s.id),1),e("div",Wt,c(s.text),1),h[0]||(h[0]=e("div",{class:"connection-point left-point"},null,-1))],10,Ut))),128))])]),e("div",Ft,[e("div",Nt,[(l(!0),r(P,null,B(t.value,(s,n)=>(l(),r("div",{key:n,class:"connection-line"}))),128))])]),e("div",Ot,[h[3]||(h[3]=e("h4",{class:"column-title"},"右侧选项",-1)),e("div",Qt,[(l(!0),r(P,null,B(a.question.rightItems,s=>(l(),r("div",{key:s.id,class:j(["matching-item","right-item",{selected:p.value?.id===s.id,connected:m(s.id)}]),onClick:n=>C(s)},[h[2]||(h[2]=e("div",{class:"connection-point right-point"},null,-1)),e("div",Xt,c(s.id),1),e("div",Gt,c(s.text),1)],10,jt))),128))])])]),e("div",Jt,[h[5]||(h[5]=e("h4",null,"已建立的连接",-1)),e("div",Kt,[(l(!0),r(P,null,B(t.value,(s,n)=>(l(),r("div",{key:n,class:"connection-item"},[e("span",Yt,c(L(s.left)),1),o(R,{class:"connection-arrow"},{default:v(()=>[o(D)]),_:1}),e("span",Zt,c(g(s.right)),1),o(z,{size:"small",type:"danger",text:"",onClick:q=>b(n)},{default:v(()=>[o(R,null,{default:v(()=>[o(F)]),_:1})]),_:2},1032,["onClick"])]))),128)),t.value.length===0?(l(),r("div",es,[o(R,null,{default:v(()=>[o(x)]),_:1}),h[4]||(h[4]=e("span",null,"暂无连接，请点击左右两侧的选项进行连线",-1))])):H("",!0)])])]),e("div",ts,[e("span",ss,[o(R,null,{default:v(()=>[o(w)]),_:1}),h[6]||(h[6]=V(" 请点击左侧选项，再点击右侧选项来建立连接 "))])])])}}}),os=J(ns,[["__scopeId","data-v-f58818f8"]]),is={class:"listening-question"},ls={class:"question-header"},as={class:"question-title"},cs={class:"question-number"},us={class:"audio-section"},ds={class:"audio-player"},rs={class:"player-header"},_s={class:"audio-info"},vs={class:"duration"},ps={class:"player-controls"},ms={class:"progress-area"},hs={class:"waveform"},gs={class:"volume-control"},fs={key:0,class:"questions-section"},$s={class:"questions-header"},ws={class:"questions-count"},qs={class:"questions-list"},ys={class:"question-content"},ks={class:"question-index"},Cs={class:"question-text"},bs={class:"question-options"},xs=["onClick"],Ss={class:"option-indicator"},Ts={class:"radio"},Is={key:0,class:"radio-dot"},Vs={class:"option-content"},As={class:"option-label"},Ls={class:"option-text"},Rs={key:1,class:"waiting-message"},Ms=["src"],Es=X({__name:"Listening",props:{question:{},answer:{}},emits:["answer-change"],setup(A,{emit:T}){const i=A,y=T,t=f(),u=f({}),p=f(!1),_=f(!1),m=f(0),d=f(0),C=f(80),$=f(!1);i.answer&&(u.value={...i.answer});const b=W({get:()=>d.value>0?m.value/d.value*100:0,set:s=>{t.value&&d.value>0&&(t.value.currentTime=s/100*d.value)}}),L=s=>{const n=Math.floor(s/60),q=Math.floor(s%60);return`${n.toString().padStart(2,"0")}:${q.toString().padStart(2,"0")}`},g=async()=>{if(t.value)try{_.value=!0,p.value?t.value.pause():(await t.value.play(),$.value=!0)}catch(s){S.error("音频播放失败"),console.error("Audio play error:",s)}finally{_.value=!1}},a=()=>{t.value&&(d.value=t.value.duration)},h=()=>{t.value&&(m.value=t.value.currentTime)},D=()=>{p.value=!1,S.success("音频播放完成")},R=s=>{if(!t.value||d.value===0)return;const n=s.currentTarget.getBoundingClientRect(),q=(s.clientX-n.left)/n.width;t.value.currentTime=q*d.value},F=s=>{const n=Array.isArray(s)?s[0]:s;t.value&&d.value>0&&(t.value.currentTime=n/100*d.value)},z=s=>{const n=Array.isArray(s)?s[0]:s;t.value&&(t.value.volume=n/100)},x=(s,n)=>u.value[s]===n,w=(s,n)=>{u.value[s]=n,y("answer-change",{...u.value})};return Q(()=>t.value,s=>{if(s){const n=()=>{p.value=!0},q=()=>{p.value=!1};s.addEventListener("play",n),s.addEventListener("pause",q),s.volume=C.value/100,oe(()=>{s.removeEventListener("play",n),s.removeEventListener("pause",q)})}},{immediate:!0}),Q(()=>i.question.id,()=>{u.value=i.answer||{},$.value=!1,p.value=!1,m.value=0,d.value=0},{immediate:!0}),(s,n)=>{const q=k("VideoPlay"),M=k("VideoPause"),K=G,U=Z,N=_e,Y=k("MuteNotification"),te=k("Headset");return l(),r("div",is,[e("div",ls,[e("h3",as,c(s.question.title),1),e("div",cs,"第 "+c(s.question.id)+" 题",1)]),e("div",us,[e("div",ds,[e("div",rs,[n[2]||(n[2]=e("h4",null,"音频材料",-1)),e("div",_s,[e("span",vs,c(L(m.value))+" / "+c(L(d.value)),1)])]),e("div",ps,[o(U,{type:p.value?"warning":"primary",circle:"",size:"large",onClick:g,loading:_.value},{default:v(()=>[o(K,null,{default:v(()=>[p.value?(l(),E(M,{key:1})):(l(),E(q,{key:0}))]),_:1})]),_:1},8,["type","loading"]),e("div",ms,[e("div",{class:"waveform-container",onClick:R},[e("div",hs,[(l(),r(P,null,B(50,I=>e("div",{key:I,class:j(["waveform-bar",{active:I<=m.value/d.value*50}]),style:ee({height:`${Math.random()*40+10}px`})},null,6)),64))]),e("div",{class:"progress-line",style:ee({width:`${m.value/d.value*100}%`})},null,4)]),o(N,{modelValue:b.value,"onUpdate:modelValue":n[0]||(n[0]=I=>b.value=I),max:100,"show-tooltip":!1,onInput:F,class:"audio-slider"},null,8,["modelValue"])]),e("div",gs,[o(K,null,{default:v(()=>[o(Y)]),_:1}),o(N,{modelValue:C.value,"onUpdate:modelValue":n[1]||(n[1]=I=>C.value=I),max:100,"show-tooltip":!1,onInput:z,style:{width:"80px","margin-left":"8px"}},null,8,["modelValue"])])])])]),$.value?(l(),r("div",fs,[e("div",$s,[n[3]||(n[3]=e("h4",null,"听力题目",-1)),e("span",ws,"共 "+c(s.question.questions.length)+" 题",1)]),e("div",qs,[(l(!0),r(P,null,B(s.question.questions,(I,se)=>(l(),r("div",{key:I.id,class:"question-item"},[e("div",ys,[e("div",ks,c(se+1)+".",1),e("div",Cs,c(I.question),1)]),e("div",bs,[(l(!0),r(P,null,B(I.options,O=>(l(),r("div",{key:O.id,class:j(["option-item",{selected:x(I.id,O.id)}]),onClick:ie=>w(I.id,O.id)},[e("div",Ss,[e("div",Ts,[x(I.id,O.id)?(l(),r("div",Is)):H("",!0)])]),e("div",Vs,[e("span",As,c(O.id)+".",1),e("span",Ls,c(O.text),1)])],10,xs))),128))])]))),128))])])):(l(),r("div",Rs,[o(K,null,{default:v(()=>[o(te)]),_:1}),n[4]||(n[4]=e("h4",null,"请先播放音频",-1)),n[5]||(n[5]=e("p",null,"点击播放按钮开始听音频，播放后题目将显示",-1))])),e("audio",{ref_key:"audioRef",ref:t,src:s.question.audioUrl,onLoadedmetadata:a,onTimeupdate:h,onEnded:D,preload:"metadata"},null,40,Ms)])}}}),Ps=J(Es,[["__scopeId","data-v-97e3f521"]]),Bs={class:"speaking-question"},Ds={class:"question-header"},zs={class:"question-title"},Us={class:"question-number"},Hs={class:"question-content"},Ws={class:"question-prompt"},Fs={class:"question-text"},Ns={class:"recording-area"},Os={class:"recording-controls"},Qs={class:"timer-display"},js={class:"time-remaining"},Xs={class:"total-time"},Gs={class:"time-value"},Js={class:"record-button-area"},Ks={class:"recording-status"},Ys={key:0},Zs={key:1,class:"recording-text"},en={key:2,class:"finished-text"},tn={class:"recording-actions"},sn={key:0,class:"waveform-visualization"},nn={class:"waveform-container"},on={key:1,class:"recording-tips"},ln={class:"tip-item"},an={class:"tip-item"},cn={class:"tip-item"},un={key:0,class:"progress-section"},dn=X({__name:"Speaking",props:{question:{},answer:{}},emits:["answer-change"],setup(A,{emit:T}){const i=A,y=T,t=f("idle"),u=f(0),p=f(!1),_=f([]),m=f(null),d=f(null),C=f(0);let $=null;i.answer?.recordingData&&(d.value=i.answer.recordingData,t.value="finished");const b=W(()=>t.value==="idle"?0:t.value==="finished"?100:(i.question.timeLimit-u.value)/i.question.timeLimit*100),L=W(()=>{const s=b.value;return s<50?"#409eff":s<80?"#e6a23c":"#f56c6c"}),g=s=>{const n=Math.floor(s/60),q=s%60;return`${n.toString().padStart(2,"0")}:${q.toString().padStart(2,"0")}`},a=()=>{_.value=Array.from({length:20},()=>Math.random()*40+10)},h=()=>{u.value=i.question.timeLimit,$=setInterval(()=>{u.value>0?(u.value--,t.value==="recording"&&a()):z()},1e3)},D=()=>{$&&(clearInterval($),$=null)},R=async()=>{t.value==="idle"?await F():t.value==="recording"&&z()},F=async()=>{try{const s=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,sampleRate:44100}});m.value=new MediaRecorder(s);const n=[];m.value.ondataavailable=q=>{q.data.size>0&&n.push(q.data)},m.value.onstop=()=>{d.value=new Blob(n,{type:"audio/webm"});const q=i.question.timeLimit-u.value;y("answer-change",{recordingData:d.value,duration:q}),s.getTracks().forEach(M=>M.stop())},m.value.start(),t.value="recording",C.value=Date.now(),h(),a(),S.success("开始录音")}catch(s){S.error("无法访问麦克风，请检查权限设置"),console.error("Recording error:",s)}},z=()=>{m.value&&m.value.state==="recording"&&m.value.stop(),t.value="finished",D(),S.success("录音结束")},x=async()=>{if(d.value)try{p.value=!0;const s=new Audio(URL.createObjectURL(d.value));s.onended=()=>{p.value=!1},await s.play()}catch{S.error("播放失败"),p.value=!1}},w=()=>{t.value="idle",d.value=null,u.value=0,y("answer-change",{}),S.info("已重置录音")};return Q(()=>i.question.id,()=>{w(),i.answer?.recordingData&&(d.value=i.answer.recordingData,t.value="finished")},{immediate:!0}),oe(()=>{D()}),(s,n)=>{const q=k("Microphone"),M=k("VideoPlay"),K=k("Check"),U=G,N=Z,Y=k("VideoPause"),te=k("RefreshLeft"),I=k("InfoFilled"),se=k("Clock"),O=k("ChatDotRound"),ie=ve;return l(),r("div",Bs,[e("div",Ds,[e("h3",zs,c(s.question.title),1),e("div",Us,"第 "+c(s.question.id)+" 题",1)]),e("div",Hs,[e("div",Ws,[n[0]||(n[0]=e("h4",null,"题目要求",-1)),e("p",Fs,c(s.question.content),1)])]),e("div",Ns,[e("div",Os,[e("div",Qs,[e("div",js,[n[1]||(n[1]=e("span",{class:"time-label"},"剩余时间",-1)),e("span",{class:j(["time-value",{warning:u.value<=30}])},c(g(u.value)),3)]),e("div",Xs,[n[2]||(n[2]=e("span",{class:"time-label"},"总时长",-1)),e("span",Gs,c(g(s.question.timeLimit)),1)])]),e("div",Js,[o(N,{type:t.value==="recording"?"danger":"primary",size:"large",circle:"",onClick:R,disabled:t.value==="finished",class:"record-button"},{default:v(()=>[o(U,{size:"24"},{default:v(()=>[t.value==="idle"?(l(),E(q,{key:0})):t.value==="recording"?(l(),E(M,{key:1})):(l(),E(K,{key:2}))]),_:1})]),_:1},8,["type","disabled"]),e("div",Ks,[t.value==="idle"?(l(),r("span",Ys,"点击开始录音")):t.value==="recording"?(l(),r("span",Zs,n[3]||(n[3]=[e("span",{class:"recording-dot"},null,-1),V(" 正在录音... ")]))):(l(),r("span",en,"录音完成"))])]),e("div",tn,[t.value==="recording"?(l(),E(N,{key:0,onClick:z,type:"warning"},{default:v(()=>[o(U,null,{default:v(()=>[o(Y)]),_:1}),n[4]||(n[4]=V(" 结束录音 "))]),_:1,__:[4]})):H("",!0),t.value==="finished"?(l(),E(N,{key:1,onClick:x,loading:p.value},{default:v(()=>[o(U,null,{default:v(()=>[o(M)]),_:1}),n[5]||(n[5]=V(" 播放录音 "))]),_:1,__:[5]},8,["loading"])):H("",!0),t.value==="finished"?(l(),E(N,{key:2,onClick:w,type:"info"},{default:v(()=>[o(U,null,{default:v(()=>[o(te)]),_:1}),n[6]||(n[6]=V(" 重新录音 "))]),_:1,__:[6]})):H("",!0)])]),t.value==="recording"?(l(),r("div",sn,[e("div",nn,[(l(),r(P,null,B(40,ne=>e("div",{key:ne,class:"wave-bar",style:ee({height:`${_.value[ne%_.value.length]}px`,animationDelay:`${ne*.1}s`})},null,4)),64))])])):H("",!0),t.value==="idle"?(l(),r("div",on,[e("div",ln,[o(U,null,{default:v(()=>[o(I)]),_:1}),n[7]||(n[7]=e("span",null,"请确保您的麦克风已启用并工作正常",-1))]),e("div",an,[o(U,null,{default:v(()=>[o(se)]),_:1}),e("span",null,"录音时间为 "+c(Math.floor(s.question.timeLimit/60))+" 分钟，请合理安排答题时间",1)]),e("div",cn,[o(U,null,{default:v(()=>[o(O)]),_:1}),n[8]||(n[8]=e("span",null,"请清楚地表达您的观点，录音将用于评分",-1))])])):H("",!0)]),t.value!=="idle"?(l(),r("div",un,[n[9]||(n[9]=e("div",{class:"progress-label"},"录音进度",-1)),o(ie,{percentage:b.value,color:L.value,"stroke-width":8},null,8,["percentage","color"])])):H("",!0)])}}}),rn=J(dn,[["__scopeId","data-v-064ca3e1"]]),_n={class:"exam-page"},vn={class:"exam-header"},pn={class:"header-content"},mn={class:"exam-info"},hn={class:"exam-type"},gn={class:"exam-progress"},fn={class:"progress-info"},$n={class:"progress-bar"},wn={class:"exam-timer"},qn={class:"exam-content"},yn={class:"question-container"},kn={class:"exam-actions"},Cn={class:"action-left"},bn={class:"action-right"},xn={class:"dialog-footer"},Sn=X({__name:"ExamView",setup(A){const T=ge(),i=f({title:"雅思模拟考试 A卷",type:"综合测试"}),y=f(0),t=f(7200),u=f(!1),p=f([{id:1,type:"choice",title:"选择题示例",content:"以下哪个选项是正确的？",options:[{id:"A",text:"选项A"},{id:"B",text:"选项B"},{id:"C",text:"选项C"},{id:"D",text:"选项D"}],multiple:!1},{id:2,type:"fill",title:"填空题示例",content:"请在空白处填入合适的单词：The weather is _____ today.",blanks:[{id:1,placeholder:"形容词"}]},{id:3,type:"writing",title:"写作题示例",content:"请写一篇不少于250字的短文，描述你对在线教育的看法。",minWords:250,maxWords:400},{id:4,type:"reading",title:"阅读理解",passage:"这里是阅读材料的内容...",questions:[{id:1,question:"根据文章内容，作者的主要观点是什么？",options:[{id:"A",text:"观点A"},{id:"B",text:"观点B"},{id:"C",text:"观点C"}]}]},{id:5,type:"matching",title:"连线题示例",leftItems:[{id:1,text:"苹果"},{id:2,text:"香蕉"},{id:3,text:"橙子"}],rightItems:[{id:"A",text:"Apple"},{id:"B",text:"Banana"},{id:"C",text:"Orange"}]},{id:6,type:"listening",title:"听力题示例",audioUrl:"/audio/sample.mp3",questions:[{id:1,question:"说话者提到了什么？",options:[{id:"A",text:"选项A"},{id:"B",text:"选项B"},{id:"C",text:"选项C"}]}]},{id:7,type:"speaking",title:"口语题示例",content:"请描述你最喜欢的季节，并说明原因。",timeLimit:180}]),_=f({}),m=W(()=>p.value[y.value]),d=W(()=>_.value[m.value?.id]||null),C=W(()=>(y.value+1)/p.value.length*100),$=W(()=>({choice:le,fill:Xe,writing:_t,reading:At,matching:os,listening:Ps,speaking:rn})[m.value?.type||"choice"]||le);let b=null;const L=()=>{b=setInterval(()=>{t.value>0?t.value--:(S.warning("考试时间已到，系统将自动提交"),R())},1e3)},g=x=>{const w=Math.floor(x/3600),s=Math.floor(x%3600/60),n=x%60;return`${w.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`},a=x=>{_.value[m.value.id]=x},h=()=>{y.value>0&&y.value--},D=()=>{y.value<p.value.length-1&&y.value++},R=()=>{u.value=!0},F=()=>{u.value=!1,S.success("考试提交成功"),T.push("/profile")},z=()=>{u.value=!1};return pe(()=>{L()}),oe(()=>{b&&clearInterval(b)}),window.addEventListener("beforeunload",x=>{x.preventDefault(),x.returnValue="确定要离开考试页面吗？"}),(x,w)=>{const s=k("Clock"),n=G,q=k("ArrowLeft"),M=Z,K=k("ArrowRight"),U=k("Check"),N=he;return l(),r("div",_n,[e("div",vn,[e("div",pn,[e("div",mn,[e("h2",null,c(i.value.title),1),e("span",hn,c(i.value.type),1)]),e("div",gn,[e("div",fn,[e("span",null,c(y.value+1)+" / "+c(p.value.length),1)]),e("div",$n,[e("div",{class:"progress-fill",style:ee({width:`${C.value}%`})},null,4)])]),e("div",wn,[o(n,null,{default:v(()=>[o(s)]),_:1}),e("span",null,c(g(t.value)),1)])])]),e("div",qn,[e("div",yn,[(l(),E(me($.value),{question:m.value,answer:d.value,onAnswerChange:a},null,40,["question","answer"]))]),e("div",kn,[e("div",Cn,[y.value>0?(l(),E(M,{key:0,onClick:h,size:"large"},{default:v(()=>[o(n,null,{default:v(()=>[o(q)]),_:1}),w[2]||(w[2]=V(" 上一题 "))]),_:1,__:[2]})):H("",!0)]),e("div",bn,[y.value<p.value.length-1?(l(),E(M,{key:0,type:"primary",onClick:D,size:"large"},{default:v(()=>[w[3]||(w[3]=V(" 下一题 ")),o(n,null,{default:v(()=>[o(K)]),_:1})]),_:1,__:[3]})):(l(),E(M,{key:1,type:"success",onClick:R,size:"large"},{default:v(()=>[w[4]||(w[4]=V(" 提交考试 ")),o(n,null,{default:v(()=>[o(U)]),_:1})]),_:1,__:[4]}))])])]),o(N,{modelValue:u.value,"onUpdate:modelValue":w[1]||(w[1]=Y=>u.value=Y),title:"提交考试",width:"400px","before-close":z},{footer:v(()=>[e("span",xn,[o(M,{onClick:w[0]||(w[0]=Y=>u.value=!1)},{default:v(()=>w[5]||(w[5]=[V("取消")])),_:1,__:[5]}),o(M,{type:"primary",onClick:F},{default:v(()=>w[6]||(w[6]=[V("确定提交")])),_:1,__:[6]})])]),default:v(()=>[w[7]||(w[7]=e("p",null,"确定要提交考试吗？提交后无法修改答案。",-1))]),_:1,__:[7]},8,["modelValue"])])}}}),En=J(Sn,[["__scopeId","data-v-4eaa7a7d"]]);export{En as default};
