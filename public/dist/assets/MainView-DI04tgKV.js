/* empty css                */import{B as J}from"./BaseCalendar-C2Z3M2lv.js";/* empty css                   */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                  */import{_ as Q}from"./logo-C4z1NPn2.js";import{d as z,y,l as c,u as F,z as D,x as _,_ as U,A as W,a as L,B as I,C as X,w as a,D as Y,b as e,e as n,r as x,h as G,t as T,F as Z,G as tt,H as et,j as O,I as nt,o as K,E as st,c as N,q as at,v as ot,f as lt,J as ct,K as rt,L as it,i as dt,g as ut,M as _t,N as ht,O as H,P as mt}from"./index-Ca6ax7r6.js";const ft=z({__name:"ScheduleLeftContent",setup(V){const S={DEFAULT:1,COMPLETED:2,CANCELLED:3},f={[S.DEFAULT]:"#123456",[S.COMPLETED]:"#90EE90",[S.CANCELLED]:"#f6d5ba"},b=()=>{const w=F(),o=D([]),h=D([]),m=D(null),v=()=>{const r=m.value?.getApi();if(r){const M=r.view;return{startDate:M.activeStart.toISOString().split("T")[0],endDate:M.activeEnd.toISOString().split("T")[0]}}const l=new Date,i=new Date(l.getFullYear(),l.getMonth(),1),g=new Date(l.getFullYear(),l.getMonth()+1,0);return{startDate:i.toISOString().split("T")[0],endDate:g.toISOString().split("T")[0]}},s=r=>{const l=m.value?.getApi();l&&(l.removeAllEvents(),l.addEventSource(r))},d=r=>f[r]||f[S.DEFAULT],t=(r,l)=>{const i=r.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",hour12:!1});if(!l)return i;const g=l.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",hour12:!1});return`${i}-${g}`},p=async()=>{try{const{startDate:r,endDate:l}=v(),i=await w.fetchAuthReq("/mapi/napi/calendar_teacher","POST",{start_date:r,end_date:l});if(i.status===0)i.data.lists?(o.value=i.data.lists,s(i.data.lists)):(o.value=h.value,s(o.value));else throw new Error(i.msg||"获取日历数据失败")}catch(r){console.error("获取日历数据失败:",r),o.value=h.value,s(o.value)}};return{calendarEvents:o,defaultCalendarEvents:h,baseCalendar:m,fetchCalendarData:p,handleDatesSet:r=>{p()},renderEventContent:r=>{const{event:l}=r,{teacher:i,subject:g,location:M,state:$}=l.extendedProps,B=t(l.start,l.end);return{html:`
                <div class="custom-event" style="background-color: ${d($)}; width: 100%;">
                    <div class="event-time">${B}</div>
                    <div class="event-teacher-subject">${g} (${i})</div>
                    <div class="event-location">${M}</div>
                </div>
            `}}}},{calendarEvents:E,baseCalendar:C,handleDatesSet:k,renderEventContent:A}=b();return(w,o)=>(_(),y(J,{ref_key:"baseCalendar",ref:C,events:c(E),"dates-set":c(k),"event-content":c(A)},null,8,["events","dates-set","event-content"]))}}),j=U(ft,[["__scopeId","data-v-62bebd0f"]]),vt={class:"schedule-stats"},pt={class:"stat-icon"},gt={class:"stat-content"},St={class:"stat-number"},Ct={class:"stat-icon"},Et={class:"stat-content"},Tt={class:"stat-number"},wt={class:"stat-icon"},Mt={class:"stat-content"},yt={class:"stat-number"},Dt={key:0,class:"upcoming-list"},Lt={class:"course-time"},bt={class:"time-label"},kt={class:"date-label"},At={class:"course-info"},xt={class:"teacher"},Rt={class:"course-status"},It={key:1,class:"empty-courses"},Ot={class:"empty-icon"},$t=z({__name:"ScheduleRightContent",setup(V,{expose:S}){const f={lastMonthTotal:"-",currentMonthTotal:"-",nextMonthTotal:"-",weekScheduleList:[]},b=()=>{const w=F(),o=D(!1),h=D({...f}),m=t=>({title:t.title,name:t.teacher,teacher:t.teacher,time:t.time,date:t.date,isSoon:t.is_soon}),v=t=>{if(t.status===0)h.value={lastMonthTotal:t.data.last_month_total||f.lastMonthTotal,currentMonthTotal:t.data.current_month_total||f.currentMonthTotal,nextMonthTotal:t.data.next_month_total||f.nextMonthTotal,weekScheduleList:t.data.week_schedule_list?.map(m)||f.weekScheduleList};else throw new Error(t.msg||"获取排课统计失败")},s=async()=>{o.value=!0;try{const t=await w.fetchAuthReq("/mapi/napi/schedule_tsummary","GET");v(t)}catch(t){console.error("获取排课统计失败:",t),K.error("获取排课统计失败")}finally{o.value=!1}};return{loadingScheduleStats:o,scheduleStats:h,fetchScheduleStats:s,refreshSummary:async()=>{await s()}}},{loadingScheduleStats:E,scheduleStats:C,fetchScheduleStats:k,refreshSummary:A}=b();return W(()=>{k()}),S({refreshSummary:A}),(w,o)=>{const h=x("Calendar"),m=G,v=Y,s=x("Check"),d=x("Clock"),t=nt,p=X;return _(),L("div",vt,[I((_(),y(v,{class:"stat-card gradient-card-schedule",shadow:"hover"},{default:a(()=>[e("div",pt,[n(m,{size:"24"},{default:a(()=>[n(h)]),_:1})]),e("div",gt,[e("div",St,T(c(C).lastMonthTotal),1),o[0]||(o[0]=e("div",{class:"stat-label"},"上月总课时",-1))])]),_:1})),[[p,c(E)]]),I((_(),y(v,{class:"stat-card gradient-card-schedule-2",shadow:"hover"},{default:a(()=>[e("div",Ct,[n(m,{size:"24"},{default:a(()=>[n(s)]),_:1})]),e("div",Et,[e("div",Tt,T(c(C).currentMonthTotal),1),o[1]||(o[1]=e("div",{class:"stat-label"},"本月总课时",-1))])]),_:1})),[[p,c(E)]]),I((_(),y(v,{class:"stat-card gradient-card-schedule-3",shadow:"hover"},{default:a(()=>[e("div",wt,[n(m,{size:"24"},{default:a(()=>[n(d)]),_:1})]),e("div",Mt,[e("div",yt,T(c(C).nextMonthTotal),1),o[2]||(o[2]=e("div",{class:"stat-label"},"下月总课时",-1))])]),_:1})),[[p,c(E)]]),I((_(),y(v,{class:"upcoming-card",shadow:"hover"},{header:a(()=>o[3]||(o[3]=[e("h4",null,"当周临近课程提醒",-1)])),default:a(()=>[c(C).weekScheduleList.length>0?(_(),L("div",Dt,[(_(!0),L(Z,null,tt(c(C).weekScheduleList,u=>(_(),L("div",{class:et(["upcoming-item",{soon:u.isSoon==1}])},[e("div",Lt,[e("div",bt,T(u.time),1),e("div",kt,T(u.date),1)]),e("div",At,[e("h5",null,T(u.title),1),e("p",xt,T(u.name),1)]),e("div",Rt,[n(t,{type:u.isSoon==1?"warning":"info",size:"small"},{default:a(()=>[O(T(u.isSoon==1?"即将开始":"待开始"),1)]),_:2},1032,["type"])])],2))),256))])):(_(),L("div",It,[e("div",Ot,[n(m,{size:"48"},{default:a(()=>[n(h)]),_:1})]),o[4]||(o[4]=e("div",{class:"empty-text"},"暂无课程安排",-1))]))]),_:1})),[[p,c(E)]])])}}}),q=U($t,[["__scopeId","data-v-b1ccdda6"]]),Bt={class:"profile-page"},Nt={class:"nav-right"},zt={class:"content-left-body"},Ft={class:"content-right-body"},Ut="https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",Vt=z({__name:"MainView",setup(V){const S={SCHEDULE:"schedule"},f={[S.SCHEDULE]:{left:j,right:q}},b=()=>{const v=ot(),s=F(),d=D(S.SCHEDULE),t=D(),p=N(()=>({avatar:s.userInfo?.avatar||Ut,nickname:s.userInfo?.nickname||"老师",school:s.userInfo?.school||"-",grade:s.userInfo?.graduate||"-"})),u=N(()=>f[d.value]?.left||j),R=N(()=>f[d.value]?.right||q);return{activeMenu:d,rightComponentRef:t,userInfo:p,leftComponent:u,rightComponent:R,refreshRightContent:async()=>{try{t.value?.refreshSummary&&await t.value.refreshSummary()}catch(g){console.error("刷新右侧内容失败:",g)}},handleMenuSelect:g=>{d.value=g},handleLogout:async()=>{try{await at.confirm("确定要退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await s.logout(v),K.success("退出成功")}catch{}}}},{activeMenu:E,rightComponentRef:C,userInfo:k,leftComponent:A,rightComponent:w,refreshRightContent:o,handleMenuSelect:h,handleLogout:m}=b();return mt("refreshRightContent",o),(v,s)=>{const d=rt,t=dt,p=x("Calendar"),u=G,R=x("SwitchButton"),r=it,l=ct,i=lt,g=Y,M=ht,$=_t,B=ut,P=st;return _(),L("div",Bt,[n(P,null,{default:a(()=>[n(i,{class:"top-nav"},{default:a(()=>[s[4]||(s[4]=e("div",{class:"nav-left"},[e("img",{src:Q,alt:"Logo",class:"logo"})],-1)),e("div",Nt,[n(l,{"default-active":c(E),class:"nav-menu",mode:"horizontal",ellipsis:!1,onSelect:c(h)},{default:a(()=>[n(d,{index:"schedule",class:"main-menu-item"},{default:a(()=>s[1]||(s[1]=[O("排课中心")])),_:1,__:[1]}),n(r,{index:"info"},{title:a(()=>[n(t,{size:36,src:c(k).avatar},null,8,["src"])]),default:a(()=>[n(d,{index:"mobile-schedule",class:"mobile-menu-item",onClick:s[0]||(s[0]=Pt=>c(h)("schedule"))},{default:a(()=>[n(u,null,{default:a(()=>[n(p)]),_:1}),s[2]||(s[2]=O(" 排课中心 "))]),_:1,__:[2]}),n(d,{index:"logout",onClick:c(m)},{default:a(()=>[n(u,null,{default:a(()=>[n(R)]),_:1}),s[3]||(s[3]=O(" 退出登录 "))]),_:1,__:[3]},8,["onClick"])]),_:1})]),_:1},8,["default-active","onSelect"])])]),_:1,__:[4]}),n(B,{class:"main-content"},{default:a(()=>[n($,{gutter:24,class:"full-width",style:{margin:"0"}},{default:a(()=>[n(M,{span:24,lg:18},{default:a(()=>[n(g,{class:"content-left"},{default:a(()=>[e("div",zt,[(_(),y(H(c(A))))])]),_:1})]),_:1}),n(M,{span:24,lg:6,class:"content-right"},{default:a(()=>[e("div",Ft,[(_(),y(H(c(w)),{ref_key:"rightComponentRef",ref:C},null,512))])]),_:1})]),_:1})]),_:1})]),_:1})])}}}),Wt=U(Vt,[["__scopeId","data-v-e2999c19"]]);export{Wt as default};
